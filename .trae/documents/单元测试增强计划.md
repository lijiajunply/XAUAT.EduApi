亲爱的主人，为了更好地保证代码质量，我计划为项目添加以下核心服务的单元测试。同时，为了遵循依赖倒置原则并使代码更易于测试，我建议对 `CookieCodeService` 进行小的重构。

### 1. 代码重构与优化
- **提取接口**：从 `CookieCodeService` 提取 `ICookieCodeService` 接口。这将允许我们在测试 `SSOLoginService` 时轻松模拟 Cookie 处理逻辑，而不是依赖具体的实现。
- **更新依赖**：修改 `SSOLoginService` 以依赖 `ICookieCodeService`，并在 `ServiceCollectionExtensions` 中更新依赖注入配置。

### 2. 新增单元测试
我将为以下关键服务创建测试类，覆盖核心业务逻辑和异常处理：

#### A. CookieCodeServiceTests
- **测试目标**：`CookieCodeService`
- **覆盖内容**：
  - `ParseCookie`：验证 Cookie 字符串的解析和拼接逻辑。
  - `GetCode`：模拟 HTTP 请求，验证从 HTML 响应中提取 Code 的正则逻辑。

#### B. SSOLoginServiceTests
- **测试目标**：`SSOLoginService`
- **覆盖内容**：
  - `LoginAsync`：验证登录成功流程、重试策略（Polly）、以及网络错误或认证失败时的异常处理。
  - 使用 `Moq` 模拟 `IHttpClientFactory` 和新的 `ICookieCodeService`。

#### C. ProgramServiceTests
- **测试目标**：`ProgramService`
- **覆盖内容**：
  - `GetAllTrainProgram`：验证从 Redis 缓存读取、缓存未命中时从 API 获取、以及数据反序列化逻辑。
  - 使用 `Moq` 模拟 `IHttpClientFactory` 和 `IConnectionMultiplexer` (Redis)。

这个计划将显著提高核心服务的测试覆盖率，确保登录和教务数据获取功能的稳定性。请问主人是否同意这个计划呢？ (◕‿◕✿)